"use strict";var packageJson=require(process.env.PWD+"/package.json"),sha1=require("sha1"),fs=require("fs-extra");function getRootPath(){return packageJson["jest-vue-report"]&&packageJson["jest-vue-report"]["report-site"]?packageJson["jest-vue-report"]["report-site"]:process.env.PWD+"/test/jestReport"}function copy2ImgJson(e,o){var n=e+"/img.json";fs.pathExists(n,function(e,t){t?fs.readJson(n,function(e,t){if(e)console.error(e);else{var s=t.names,r=s.findIndex(function(e){return e.split("_")[1]===o.split("_")[1]});r<0?s.push(o):s[r]=o,fs.writeJson(n,{names:s})}}):fs.outputJson(n,{names:[o]})})}function getIndexHtml(){return'<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><meta name="renderer" content="webkit"><title>自动化测试报告</title><link href="http://at.alicdn.com/t/font_668771_1rzkn8yfei2j4i.css" rel="stylesheet"></link><link href="https://github.com/lenvonsam/jest-vue-report/blob/master/dist/index.min.css" rel="stylesheet"></link></head><body><div id="appTest"></div><script src="https://cdn.bootcss.com/vue/2.5.16/vue.min.js"><\/script><script src="https://cdn.bootcss.com/js-sha1/0.6.0/sha1.min.js"><\/script><script src="https://github.com/lenvonsam/jest-vue-report/blob/master/dist/report.min.js"><\/script></body></html>'}function jestReporter(e){var t=getRootPath();return fs.outputFile(t+"/index.html",getIndexHtml()),fs.outputJson(t+"/testResultData.json",e),console.log('Build Jest Vue Report complete in "'+getRootPath()+'" folder'),console.log("Built files are meant to be served over an HTTP server."),console.log("Opening index.html over file:// won't work."),e}jestReporter.getScreenshotUrl=function(e){if(e){var t=getRootPath();fs.ensureDirSync(t+"/assets");var s=(new Date).getTime(),r="img_"+sha1(e)+"_"+s+".png";return copy2ImgJson(t,r),t+"/assets/"+r}return""},module.exports=jestReporter;